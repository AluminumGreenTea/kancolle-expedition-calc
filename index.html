<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>âš“ é å¾æ”¶ç›Šæœ€å¤§åŒ–è¨ˆç®—æ©Ÿ</title>
    <style>
        :root {
            --primary: #2c3e50; --fuel: #27ae60; --ammo: #d4ac0d; --steel: #7f8c8d; --bauxite: #e67e22; 
            --score: #8e44ad; --bucket: #2980b9; --bg-gray: #f4f7f6;
        }
        body { font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; background: var(--bg-gray); padding: 20px; color: #333; }
        .container { max-width: 1400px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* æ¨è–¦çµ„åˆå€å¡Š */
        .recommend-box { 
            background: linear-gradient(135deg, #2c3e50, #4ca1af); 
            color: white; padding: 20px; border-radius: 12px; margin-bottom: 25px;
            display: flex; justify-content: space-between; align-items: center; gap: 20px;
        }
        .rec-title { font-size: 1.3em; font-weight: bold; border-left: 5px solid #f39c12; padding-left: 15px; }
        .rec-cards { display: flex; gap: 10px; flex: 1; margin: 0 20px; }
        .rec-card { background: rgba(255,255,255,0.15); padding: 10px; border-radius: 8px; flex: 1; text-align: center; border: 1px solid rgba(255,255,255,0.3); }
        .rec-total { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; font-size: 0.9em; min-width: 260px; line-height: 1.6; }

        .time-box { background: #fff; border: 3px solid var(--primary); padding: 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .time-display { font-size: 1.8em; font-weight: bold; color: var(--primary); margin-bottom: 10px; }
        .main-slider { width: 90%; height: 15px; cursor: pointer; }

        .control-panel { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); 
            gap: 12px; background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #dee2e6;
        }
        .-titlesection { grid-column: 1 / -1; font-weight: bold; color: var(--primary); border-bottom: 2px solid #ddd; padding-bottom: 5px; margin-bottom: 10px; }
        .weight-item { display: flex; flex-direction: column; gap: 5px; }
        .weight-item label { font-size: 0.85em; font-weight: bold; }
        .weight-item input { padding: 6px; border: 1px solid #ccc; border-radius: 4px; }

        .tool-bar { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; align-items: center; }
        .search-box { flex: 2; min-width: 200px; padding: 12px; border: 2px solid var(--primary); border-radius: 8px; font-size: 1.1em; }
        .btn { padding: 10px 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: white; transition: 0.2s; font-size: 13px; }
        
        .btn-gs { background: #7f8c8d; }
        .btn-gs.active { background: #f39c12; border: 1px solid #000; }
        .btn-toggle { background: #7f8c8d; }
        .btn-toggle.active { background: #e74c3c; border: 1px solid #000; }
        .btn-mon.active { background: #9b59b6; border: 1px solid #000; }

        .badge { font-size: 11px; padding: 3px 7px; border-radius: 4px; color: white; margin-right: 3px; display: inline-block; font-weight: bold; }
        .tag-bucket { background: var(--bucket); }
        .tag-fuel { background: var(--fuel); }
        .tag-ammo { background: var(--ammo); }
        .tag-steel { background: var(--steel); }
        .tag-bauxite { background: var(--bauxite); }
        .tag-monthly { background: #8e44ad; }
        .tag-combat { background: #e74c3c; }

        .res-fuel { color: var(--fuel); font-weight: bold; }
        .res-ammo { color: var(--ammo); font-weight: bold; }
        .res-steel { color: var(--steel); font-weight: bold; }
        .res-bauxite { color: var(--bauxite); font-weight: bold; }

        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th { background: var(--primary); color: white; cursor: pointer; padding: 12px; font-size: 13px; position: sticky; top: 0; }
        td { border-bottom: 1px solid #eee; padding: 10px; text-align: center; font-size: 14px; }
        tr:hover { background-color: #f1f7ff; }
        tr.disabled { opacity: 0.3; background: #ebebeb; filter: grayscale(0.5); }
        .score-col { background: #fdfaff; font-weight: bold; color: var(--score); border-left: 2px solid #eee; }
    </style>
</head>
<body>

<div class="container">
    <div class="recommend-box">
        <div class="rec-title">ğŸ† æœ€ä½³æ•ˆç‡æ¨è–¦çµ„åˆ</div>
        <div class="rec-cards" id="recFleetCards"></div>
        <div class="rec-total" id="recTotalStats"></div>
    </div>

    <div class="time-box">
        <div class="time-display">â° æç£å›æ¸¯é–“éš”ï¼š<span id="textTime">0 å°æ™‚ 0 åˆ†é˜</span></div>
        <input type="range" id="intervalSlider" class="main-slider" min="0" max="720" step="5" value="0" oninput="updateTime()">
    </div>

    <div class="tool-bar">
        <input type="text" id="searchBar" class="search-box" placeholder="ğŸ” æœå°‹ä»»å‹™å…§å®¹...">
        <button class="btn" style="background:#27ae60" onclick="applyPreset('fuel')">â›½ ç¼ºç‡ƒ</button>
        <button class="btn" style="background:#d4ac0d" onclick="applyPreset('ammo')">ğŸ’£ ç¼ºå½ˆ</button>
        <button class="btn" style="background:#2980b9" onclick="applyPreset('bucket')">ğŸ’§ ç¼ºæ¡¶</button>
        <button class="btn" style="background:#7f8c8d" onclick="applyPreset('reset')">ğŸ”„ é‡ç½®</button>
        <button id="btnGS" class="btn btn-gs active" onclick="toggleOption('isGS')">âœ¨ å¤§æˆåŠŸ: ON</button>
        <button id="btnMon" class="btn btn-toggle" onclick="toggleOption('hideMonthly')">ğŸš« éš±è—æœˆå¸¸: OFF</button>
        <button id="btnLimit" class="btn btn-toggle" onclick="toggleOption('hideOvertime')">â³ éš±è—ä¸åˆé©: OFF</button>
    </div>

    <div class="control-panel">
        <div class="section-title">âš–ï¸ æ”¶ç›Šæ¬Šé‡è¨­å®š</div>
        <div class="weight-item"><label>â›½ ç‡ƒæ–™</label><input type="number" id="w_fuel" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ’£ å½ˆè—¥</label><input type="number" id="w_ammo" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ—ï¸ é‹¼æ</label><input type="number" id="w_steel" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>âœˆï¸ é‹åœŸ</label><input type="number" id="w_bauxite" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ’§ æ°´æ¡¶</label><input type="number" id="w_bucket" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ”¨ èºçµ²</label><input type="number" id="w_screw" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ”« ç«æ§</label><input type="number" id="w_torch" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ“¦ å°ç®±</label><input type="number" id="w_boxS" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ“¦ ä¸­ç®±</label><input type="number" id="w_boxM" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ“¦ å¤§ç®±</label><input type="number" id="w_boxL" value="1.0" oninput="updateUI()"></div>
        <div class="weight-item"><label>ğŸ’° å¤§ç™¼%</label><input type="number" id="w_daihatsu" value="1.0" oninput="updateUI()"></div>
    </div>

    <table id="mainTable">
        <thead>
            <tr>
                <th width="60" onclick="resort('id')">ID</th>
                <th style="text-align:left">åç¨± / æ¨™ç±¤</th>
                <th width="90" onclick="resort('duration')">æ™‚é–“</th>
                <th width="85" onclick="resort('yieldFuel')">ç‡ƒæ–™/hr</th>
                <th width="85" onclick="resort('yieldAmmo')">å½ˆè—¥/hr</th>
                <th width="85" onclick="resort('yieldSteel')">é‹¼æ/hr</th>
                <th width="85" onclick="resort('yieldBauxite')">é‹åœŸ/hr</th>
                <th width="150">å‰¯ç”¢ç‰©/hr</th>
                <th width="100" onclick="resort('score')" class="score-col">è©•åˆ†</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>
</div>

<script>

const expeditionDB = [
    // --- ç¬¬ 1 æµ·åŸŸï¼šé®å®ˆåºœæµ·åŸŸ ---
    {id:"1", area:"1", name:"ç·´ç¿’èˆªæµ·", duration:15, fuel:0, ammo:30, steel:0, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},   
    {id:"2", area:"1", name:"é•·è·é›¢ç·´ç¿’èˆªæµ·", duration:30, fuel:0, ammo:100, steel:30, bauxite:0, bucket:1, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æ°´æ¡¶"]},
    {id:"3", area:"1", name:"è­¦å‚™ä»»å‹™", duration:20, fuel:30, ammo:30, steel:40, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},
    {id:"4", area:"1", name:"å¯¾æ½œè­¦æˆ’ä»»å‹™", duration:50, fuel:0, ammo:70, steel:0, bauxite:0, bucket:1, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æ°´æ¡¶"]},
    {id:"5", area:"1", name:"æµ·ä¸Šè­·è¡›ä»»å‹™", duration:90, fuel:200, ammo:200, steel:20, bauxite:20, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","ç‡ƒæ–™","å½ˆè—¥"]},
    {id:"6", area:"1", name:"é˜²ç©ºå°„æ’ƒæ¼”ç¿’", duration:40, fuel:0, ammo:0, steel:0, bauxite:80, bucket:0, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","é‹åœŸ"]},
    {id:"7", area:"1", name:"è¦³è‰¦å¼äºˆè¡Œ", duration:60, fuel:0, ammo:0, steel:50, bauxite:30, bucket:0, torch:1, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},
    {id:"8", area:"1", name:"è¦³è‰¦å¼", duration:180, fuel:50, ammo:100, steel:50, bauxite:50, bucket:0, torch:2, devMat:1, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},
    {id:"A1", area:"1", name:"å…µç«™å¼·åŒ–ä»»å‹™", duration:25, fuel:45, ammo:45, steel:0, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},
    {id:"A2", area:"1", name:"æµ·å³¡è­¦å‚™è¡Œå‹•", duration:55, fuel:70, ammo:40, steel:0, bauxite:10, bucket:1, torch:0, devMat:1, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æ°´æ¡¶"]},
    {id:"A3", area:"1", name:"é•·æ™‚é–“å¯¾æ½œè­¦æˆ’", duration:135, fuel:120, ammo:0, steel:60, bauxite:60, bucket:1, torch:0, devMat:2, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ"]},
    {id:"A4", area:"1", name:"å—è¥¿æ–¹é¢é€£çµ¡ç·šå“¨æˆ’â€»", duration:110, fuel:80, ammo:120, steel:0, bauxite:100, bucket:2, torch:2, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æœˆå¸¸"]},
    {id:"A5", area:"1", name:"å°ç¬ åŸæ²–å“¨æˆ’ç·šâ€»", duration:180, fuel:0, ammo:300, steel:0, bauxite:100, bucket:3, torch:0, devMat:4, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æœˆå¸¸"]},
    {id:"A6", area:"1", name:"å°ç¬ åŸæ²–æˆ¦é—˜å“¨æˆ’â€»", duration:210, fuel:100, ammo:500, steel:100, bauxite:200, bucket:0, torch:0, devMat:5, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬1æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°"]},

    // --- ç¬¬ 2 æµ·åŸŸï¼šå—è¥¿è«¸å³¶æµ·åŸŸ ---
    {id:"9", area:"1", name:"ã‚¿ãƒ³ã‚«ãƒ¼è­·è¡›ä»»å‹™", duration:240, fuel:350, ammo:0, steel:0, bauxite:0, bucket:2, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","ç‡ƒæ–™"]},
    {id:"10", area:"1", name:"å¼·è¡Œåµå¯Ÿä»»å‹™", duration:90, fuel:0, ammo:50, steel:0, bauxite:40, bucket:1, torch:1, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ"]},
    {id:"11", area:"1", name:"ãƒœãƒ¼ã‚­ã‚µã‚¤ãƒˆè¼¸é€ä»»å‹™", duration:300, fuel:0, ammo:0, steel:0, bauxite:250, bucket:1, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","é‹åœŸ"]},
    {id:"12", area:"1", name:"è³‡æºè¼¸é€ä»»å‹™", duration:480, fuel:50, ammo:250, steel:200, bauxite:50, bucket:0, torch:0, devMat:1, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬2æµ·åŸŸ"]},
    {id:"13", area:"1", name:"é¼ è¼¸é€ä½œæˆ¦", duration:240, fuel:240, ammo:300, steel:0, bauxite:0, bucket:2, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","ç‡ƒæ–™","å½ˆè—¥"]},
    {id:"14", area:"1", name:"åŒ…å›²é™¸æˆ¦éšŠæ’¤åä½œæˆ¦", duration:360, fuel:0, ammo:280, steel:200, bauxite:30, bucket:1, torch:0, devMat:1, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ"]},
    {id:"15", area:"1", name:"å›®æ©Ÿå‹•éƒ¨éšŠæ”¯æ´ä½œæˆ¦", duration:720, fuel:0, ammo:0, steel:300, bauxite:400, bucket:0, torch:0, devMat:1, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬2æµ·åŸŸ","é‹åœŸ"]},
    {id:"16", area:"1", name:"è‰¦éšŠæ±ºæˆ¦æ´è­·ä½œæˆ¦", duration:900, fuel:500, ammo:500, steel:200, bauxite:200, bucket:0, torch:2, devMat:2, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ"]},
    {id:"B1", area:"1", name:"å—è¥¿æ–¹é¢èˆªç©ºåµå¯Ÿä½œæˆ¦", duration:35, fuel:0, ammo:0, steel:20, bauxite:30, bucket:1, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸"]},
    {id:"B2", area:"1", name:"æ•µæ³Šåœ°å¼·è¥²åæ’ƒä½œæˆ¦â€»", duration:520, fuel:300, ammo:200, steel:100, bauxite:0, bucket:2, torch:0, devMat:2, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°"]},
    {id:"B3", area:"1", name:"å—è¥¿è«¸å³¶é›¢å³¶å“¨æˆ’ä½œæˆ¦â€»", duration:170, fuel:0, ammo:100, steel:100, bauxite:180, bucket:2, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸"]},
    {id:"B4", area:"1", name:"å—è¥¿è«¸å³¶é›¢å³¶é˜²è¡›ä½œæˆ¦â€»", duration:450, fuel:0, ammo:0, steel:1200, bauxite:650, bucket:0, torch:0, devMat:4, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°","ç‡ƒæ–™"]},
    {id:"B5", area:"1", name:"å—è¥¿è«¸å³¶æœç´¢æ’ƒæ»…æˆ¦â€»", duration:390, fuel:500, ammo:500, steel:1000, bauxite:750, bucket:4, torch:0, devMat:0, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°"]},
    {id:"B6", area:"1", name:"ç²¾é‹­æ°´é›·æˆ¦éšŠå¤œè¥²â€»", duration:350, fuel:600, ammo:1000, steel:600, bauxite:600, bucket:0, torch:0, devMat:5, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬2æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°"]},

    // --- ç¬¬ 3 æµ·åŸŸï¼šåŒ—æ–¹æµ·åŸŸ ---
    {id:"17", area:"1", name:"æ•µåœ°åµå¯Ÿä½œæˆ¦", duration:45, fuel:70, ammo:90, steel:50, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ"]},
    {id:"18", area:"1", name:"èˆªç©ºæ©Ÿè¼¸é€ä½œæˆ¦", duration:300, fuel:0, ammo:0, steel:300, bauxite:150, bucket:1, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ"]},
    {id:"19", area:"1", name:"åŒ—å·ä½œæˆ¦", duration:360, fuel:400, ammo:50, steel:50, bauxite:30, bucket:0, torch:0, devMat:1, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ","ç‡ƒæ–™"]},
    {id:"20", area:"1", name:"æ½œæ°´è‰¦å“¨æˆ’ä»»å‹™", duration:120, fuel:0, ammo:0, steel:150, bauxite:0, bucket:0, torch:0, devMat:1, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬3æµ·åŸŸ"]},
    {id:"21", area:"1", name:"åŒ—æ–¹é¼ è¼¸é€ä½œæˆ¦", duration:140, fuel:320, ammo:270, steel:0, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ","ç‡ƒæ–™","å½ˆè—¥"]},
    {id:"22", area:"1", name:"è‰¦éšŠæ¼”ç¿’", duration:180, fuel:0, ammo:10, steel:0, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ"]},
    {id:"23", area:"1", name:"èˆªç©ºæˆ¦è‰¦é‹ç”¨æ¼”ç¿’", duration:240, fuel:0, ammo:50, steel:0, bauxite:130, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬3æµ·åŸŸ"]},
    {id:"24", area:"1", name:"åŒ—æ–¹èˆªè·¯æµ·ä¸Šè­·è¡›", duration:500, fuel:500, ammo:0, steel:0, bauxite:150, bucket:1, torch:0, devMat:2, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬3æµ·åŸŸ","ç‡ƒæ–™"]},

    // --- ç¬¬ 4 æµ·åŸŸï¼šè¥¿æ–¹æµ·åŸŸ ---
    {id:"25", area:"1", name:"é€šå•†ç ´å£Šä½œæˆ¦", duration:2400, fuel:900, ammo:0, steel:500, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"26", area:"1", name:"æ•µæ¯æ¸¯ç©ºè¥²ä½œæˆ¦", duration:4800, fuel:0, ammo:0, steel:0, bauxite:900, bucket:3, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"27", area:"1", name:"æ½œæ°´è‰¦é€šå•†ç ´å£Šä½œæˆ¦", duration:1200, fuel:0, ammo:0, steel:800, bauxite:0, bucket:0, torch:0, devMat:2, screw:0, boxS:2, boxM:0, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"28", area:"1", name:"è¥¿æ–¹æµ·åŸŸå°é–ä½œæˆ¦", duration:1500, fuel:0, ammo:0, steel:900, bauxite:350, bucket:0, torch:0, devMat:3, screw:0, boxS:0, boxM:2, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"29", area:"1", name:"æ½œæ°´è‰¦æ´¾é£æ¼”ç¿’", duration:1440, fuel:0, ammo:50, steel:0, bauxite:100, bucket:0, torch:0, devMat:1, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"30", area:"1", name:"æ½œæ°´è‰¦æ´¾é£ä½œæˆ¦", duration:2880, fuel:0, ammo:50, steel:0, bauxite:100, bucket:0, torch:0, devMat:3, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"31", area:"1", name:"æµ·å¤–è‰¦ã¨ã®æ¥è§¦", duration:120, fuel:0, ammo:30, steel:0, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"32", area:"1", name:"é æ´‹ç·´ç¿’èˆªæµ·", duration:1440, fuel:50, ammo:50, steel:50, bauxite:50, bucket:0, torch:0, devMat:3, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"D1", area:"1", name:"è¥¿æ–¹æµ·åŸŸåµå¯Ÿä½œæˆ¦", duration:120, fuel:0, ammo:20, steel:20, bauxite:100, bucket:1, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬4æµ·åŸŸ"]},
    {id:"D2", area:"1", name:"è¥¿æ–¹æ½œæ°´è‰¦ä½œæˆ¦â€»", duration:600, fuel:0, ammo:0, steel:400, bauxite:800, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬4æµ·åŸŸ","æœˆå¸¸","é‹åœŸ"]},
    {id:"D3", area:"1", name:"æ¬§å·æ–¹é¢å‹è»ã¨ã®æ¥è§¦â€»", duration:720, fuel:0, ammo:800, steel:500, bauxite:400, bucket:3, torch:0, devMat:0, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬4æµ·åŸŸ","æœˆå¸¸"]},

    // --- ç¬¬ 5 æµ·åŸŸï¼šå—æ–¹æµ·åŸŸ ---
    {id:"35", area:"1", name:"MOä½œæˆ¦", duration:420, fuel:0, ammo:0, steel:240, bauxite:280, bucket:0, torch:0, devMat:1, screw:0, boxS:2, boxM:0, boxL:0, tags:["ç¬¬5æµ·åŸŸ","é‹åœŸ"]},
    {id:"36", area:"1", name:"æ°´ä¸Šæ©ŸåŸºåœ°å»ºè¨­", duration:540, fuel:480, ammo:0, steel:200, bauxite:200, bucket:1, torch:0, devMat:0, screw:0, boxS:0, boxM:2, boxL:0, tags:["ç¬¬5æµ·åŸŸ","ç‡ƒæ–™"]},
    {id:"37", area:"1", name:"æ±äº¬æ€¥è¡Œ", duration:165, fuel:0, ammo:380, steel:270, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬5æµ·åŸŸ","å½ˆè—¥","é‹¼æ"]},
    {id:"38", area:"1", name:"æ±äº¬æ€¥è¡Œï¼ˆå¼ï¼‰", duration:175, fuel:420, ammo:0, steel:200, bauxite:0, bucket:0, torch:0, devMat:0, screw:0, boxS:1, boxM:0, boxL:0, tags:["ç¬¬5æµ·åŸŸ","ç‡ƒæ–™","é‹¼æ"]},
    {id:"39", area:"1", name:"é æ´‹æ½œæ°´è‰¦ä½œæˆ¦", duration:1800, fuel:0, ammo:0, steel:300, bauxite:0, bucket:2, torch:0, devMat:0, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬5æµ·åŸŸ"]},
    {id:"40", area:"1", name:"æ°´ä¸Šæ©Ÿå‰ç·šè¼¸é€", duration:410, fuel:300, ammo:300, steel:0, bauxite:100, bucket:1, torch:0, devMat:0, screw:0, boxS:3, boxM:0, boxL:0, tags:["ç¬¬5æµ·åŸŸ"]},
    {id:"E1", area:"1", name:"ãƒ©ãƒã‚¦ãƒ«æ–¹é¢è‰¦éšŠé€²å‡ºâ€»", duration:450, fuel:0, ammo:600, steel:600, bauxite:1000, bucket:0, torch:0, devMat:0, screw:1, boxS:0, boxM:0, boxL:2, tags:["ç¬¬5æµ·åŸŸ","æœˆå¸¸"]},
    {id:"E2", area:"1", name:"å¼·è¡Œé¼ è¼¸é€ä½œæˆ¦â€»", duration:185, fuel:0, ammo:480, steel:0, bauxite:0, bucket:2, torch:0, devMat:0, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬5æµ·åŸŸ","æœˆå¸¸","æ°´æ¡¶"]},

    // --- ç¬¬ 7 æµ·åŸŸï¼šå—è¥¿æµ·åŸŸ ---
    {id:"41", area:"1", name:"ãƒ–ãƒ«ãƒã‚¤æ³Šåœ°æ²–å“¨æˆ’", duration:60, fuel:100, ammo:0, steel:0, bauxite:20, bucket:1, torch:0, devMat:1, screw:0, boxS:0, boxM:0, boxL:0, tags:["ç¬¬7æµ·åŸŸ","ç‡ƒæ–™","å½ˆè—¥","æ°´æ¡¶"]},
    {id:"42", area:"1", name:"ãƒŸèˆ¹å›£è­·è¡›(ä¸€å·èˆ¹å›£)â€»", duration:480, fuel:800, ammo:0, steel:0, bauxite:200, bucket:0, torch:3, devMat:0, screw:0, boxS:0, boxM:0, boxL:1, tags:["ç¬¬7æµ·åŸŸ","æœˆå¸¸","ç‡ƒæ–™"]},
    {id:"43", area:"1", name:"ãƒŸèˆ¹å›£è­·è¡›(äºŒå·èˆ¹å›£)â€»", duration:720, fuel:2000, ammo:0, steel:0, bauxite:400, bucket:0, torch:0, devMat:4, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬7æµ·åŸŸ","æœˆå¸¸","ç‡ƒæ–™"]},
    {id:"44", area:"1", name:"èˆªç©ºè£…å‚™è¼¸é€ä»»å‹™â€»", duration:600, fuel:0, ammo:200, steel:0, bauxite:800, bucket:0, torch:0, devMat:4, screw:0, boxS:0, boxM:0, boxL:2, tags:["ç¬¬7æµ·åŸŸ","æœˆå¸¸","é‹åœŸ"]},
    {id:"45", area:"1", name:"ãƒœãƒ¼ã‚­ã‚µã‚¤ãƒˆèˆ¹å›£è­·è¡›", duration:200, fuel:40, ammo:0, steel:0, bauxite:220, bucket:0, torch:0, devMat:0, screw:0, boxS:0, boxM:1, boxL:0, tags:["ç¬¬7æµ·åŸŸ","é‹åœŸ"]},
    {id:"46", area:"1", name:"å—è¥¿æµ·åŸŸæˆ¦é—˜å“¨æˆ’â€»", duration:210, fuel:300, ammo:0, steel:150, bauxite:380, bucket:0, torch:0, devMat:3, screw:1, boxS:0, boxM:0, boxL:0, tags:["ç¬¬7æµ·åŸŸ","æœˆå¸¸","äº¤æˆ°"]}
];

let state = { isGS: true, hideMonthly: false, hideOvertime: false, sortKey: 'score', isAsc: false };

function toggleOption(key) {
    state[key] = !state[key];
    const btnMap = { isGS: 'btnGS', hideMonthly: 'btnMon', hideOvertime: 'btnLimit' };
    const labels = { isGS: 'âœ¨ å¤§æˆåŠŸ', hideMonthly: 'ğŸš« éš±è—æœˆå¸¸', hideOvertime: 'â³ éš±è—ä¸åˆé©' };
    document.getElementById(btnMap[key]).innerText = `${labels[key]}: ${state[key]?'ON':'OFF'}`;
    document.getElementById(btnMap[key]).classList.toggle('active', state[key]);
    updateUI();
}

function applyPreset(mode) {
    const fields = ['w_fuel', 'w_ammo', 'w_steel', 'w_bauxite', 'w_bucket', 'w_screw', 'w_torch', 'w_devMat', 'w_boxS', 'w_boxM', 'w_boxL', 'w_daihatsu'];
    if (mode === 'reset') {
        const vals = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0];
        fields.forEach((id, i) => document.getElementById(id).value = vals[i]);
    } else {
        fields.forEach(id => document.getElementById(id).value = 0.1);
        if (mode === 'fuel') { document.getElementById('w_fuel').value = 3.0; document.getElementById('w_bucket').value = 50; }
        else if (mode === 'ammo') { document.getElementById('w_ammo').value = 3.0; document.getElementById('w_bucket').value = 50; }
        else if (mode === 'bucket') { document.getElementById('w_bucket').value = 500; document.getElementById('w_fuel').value = 0.5; }
        document.getElementById('w_daihatsu').value = 20;
    }
    updateUI();
}

function updateTime() {
    const val = parseInt(document.getElementById('intervalSlider').value);
    document.getElementById('textTime').innerText = `${Math.floor(val/60)} å°æ™‚ ${val%60} åˆ†é˜`;
    updateUI();
}

function updateUI() {
    const playerInterval = parseInt(document.getElementById('intervalSlider').value);
    const search = document.getElementById('searchBar').value.toLowerCase().trim();
    
    const weights = {
        fuel: parseFloat(document.getElementById('w_fuel').value)||0,
        ammo: parseFloat(document.getElementById('w_ammo').value)||0,
        steel: parseFloat(document.getElementById('w_steel').value)||0,
        bauxite: parseFloat(document.getElementById('w_bauxite').value)||0,
        bucket: parseFloat(document.getElementById('w_bucket').value)||0,
        screw: parseFloat(document.getElementById('w_screw').value)||0,
        torch: parseFloat(document.getElementById('w_torch').value)||0,
        boxS: parseFloat(document.getElementById('w_boxS').value)||0,
        boxM: parseFloat(document.getElementById('w_boxM').value)||0,
        boxL: parseFloat(document.getElementById('w_boxL').value)||0
    };

    const daihatsu = 1 + (parseFloat(document.getElementById('w_daihatsu').value)||0)/100;
    const gsMult = state.isGS ? 1.5 : 1.0;

    let rows = expeditionDB.map(exp => {
        const effectiveTime = Math.max(exp.duration, playerInterval);
        const hourlyFactor = 60 / effectiveTime;

        const yieldFuel = (exp.fuel * gsMult * daihatsu) * hourlyFactor;
        const yieldAmmo = (exp.ammo * gsMult * daihatsu) * hourlyFactor;
        const yieldSteel = (exp.steel * gsMult * daihatsu) * hourlyFactor;
        const yieldBauxite = (exp.bauxite * gsMult * daihatsu) * hourlyFactor;
        
        const prob = state.isGS ? 1.0 : 0.5;
        const yieldBucket = (exp.bucket || 0) * prob * hourlyFactor;
        const yieldScrew = (exp.screw || 0) * (state.isGS ? 1 : 0) * hourlyFactor;
        const yieldTorch = (exp.torch || 0) * prob * hourlyFactor;
        const yieldBoxS = (exp.boxS || 0) * prob * hourlyFactor;
        const yieldBoxM = (exp.boxM || 0) * prob * hourlyFactor;
        const yieldBoxL = (exp.boxL || 0) * prob * hourlyFactor;

        const score = (yieldFuel * weights.fuel) + (yieldAmmo * weights.ammo) + (yieldSteel * weights.steel) + 
                      (yieldBauxite * weights.bauxite) + (yieldBucket * weights.bucket) + (yieldScrew * weights.screw) + 
                      (yieldTorch * weights.torch) + (yieldBoxS * weights.boxS) + (yieldBoxM * weights.boxM) + (yieldBoxL * weights.boxL);

        // --- âš¡ è®Šç°èˆ‡éš±è—åˆ¤å®šé‚è¼¯ âš¡ ---
        // 1. æ˜¯å¦å¤ªçŸ­ï¼šé å¾æ™‚é–“ä¸åˆ°é–“éš”çš„ 80% (ä»£è¡¨æç£æœƒæµªè²»è¶…é 20% çš„é–’ç½®æ™‚é–“)
        const isTooShort = (playerInterval > 0) && (exp.duration < playerInterval * 0.8);
        // 2. æ˜¯å¦å¤ªé•·ï¼šé å¾æ™‚é–“è¶…éé–“éš” + 15 åˆ†é˜å¯¬é™
        const isTooLong = (playerInterval > 0) && (exp.duration > playerInterval + 120);
        
        // åªæœ‰åœ¨é–“éš”è¨­å®šå¤§æ–¼ 0 æ™‚æ‰è§¸ç™¼åˆ¤å®š
        const isNotFit = (playerInterval > 0) && (isTooShort || isTooLong);

        return { ...exp, yieldFuel, yieldAmmo, yieldSteel, yieldBauxite, yieldBucket, yieldScrew, yieldTorch, score, isNotFit, isTooLong };
    }).filter(exp => {
        if (state.hideMonthly && exp.tags.includes("æœˆå¸¸")) return false;
        // å¦‚æœé–‹å•Ÿã€Œéš±è—ä¸åˆé©ã€ï¼Œå‰‡éæ¿¾æ‰å¤ªé•·æˆ–å¤ªçŸ­çš„
        if (state.hideOvertime && exp.isNotFit) return false;
        return (exp.id + exp.name + exp.tags.join(',')).toLowerCase().includes(search);
    });

    // æ›´æ–°æ¨è–¦ (æ¨è–¦å€åªé¸äº®çš„é …ç›®)
    const recs = [...rows].filter(r => !r.isNotFit).sort((a,b) => b.score - a.score).slice(0, 3);
    const recCards = document.getElementById('recFleetCards');
    const recStats = document.getElementById('recTotalStats');

    if(recs.length > 0) {
        recCards.innerHTML = recs.map((r, i) => `
            <div class="rec-card">
                <div style="font-size:0.75em; color:#f39c12; font-weight:bold;">ç¬¬ ${i+2} è‰¦éšŠ</div>
                <div style="font-size:1.1em; font-weight:bold; margin:2px 0;">${r.id}</div>
                <div style="font-size:0.8em; opacity:0.9;">${r.name}</div>
            </div>
        `).join('');
        const sumF = recs.reduce((s, r) => s + r.yieldFuel, 0);
        const sumA = recs.reduce((s, r) => s + r.yieldAmmo, 0);
        const sumBkt = recs.reduce((s, r) => s + r.yieldBucket, 0);
        recStats.innerHTML = `<b>çµ„åˆæ™‚æ”¶ç¸½è¨ˆï¼š</b><br>â›½ç‡ƒï¼š${sumF.toFixed(0)} | ğŸ’£å½ˆï¼š${sumA.toFixed(0)}<br>ğŸ’§æ¡¶ï¼š${sumBkt.toFixed(1)} / å°æ™‚`;
    } else {
        recCards.innerHTML = "ç„¡åŒ¹é…çµ„åˆ"; recStats.innerHTML = "";
    }

    rows.sort((a,b) => {
        if (state.sortKey === 'id') return state.isAsc ? a.id.localeCompare(b.id, undefined, {numeric:true}) : b.id.localeCompare(a.id, undefined, {numeric:true});
        return state.isAsc ? a[state.sortKey] - b[state.sortKey] : b[state.sortKey] - a[state.sortKey];
    });

    document.getElementById('tbody').innerHTML = rows.map(exp => `
        <tr class="${exp.isNotFit ? 'disabled' : ''}">
            <td><b>${exp.id}</b></td>
            <td style="text-align:left">
                <div style="font-weight:bold; margin-bottom:4px;">${exp.name}</div>
                ${exp.tags.map(t => `<span class="badge ${getTagClass(t)}">${t}</span>`).join('')}
            </td>
            <td>${exp.duration}m</td>
            <td class="res-fuel">${exp.yieldFuel.toFixed(0)}</td>
            <td class="res-ammo">${exp.yieldAmmo.toFixed(0)}</td>
            <td class="res-steel">${exp.yieldSteel.toFixed(0)}</td>
            <td class="res-bauxite">${exp.yieldBauxite.toFixed(0)}</td>
            <td style="font-size:0.85em; text-align:left;">
                ${exp.yieldBucket>0?`ğŸ’§${exp.yieldBucket.toFixed(1)} `:''}${exp.yieldScrew>0?`ğŸ”¨${exp.yieldScrew.toFixed(1)} `:''}${exp.yieldTorch>0?`ğŸ”«${exp.yieldTorch.toFixed(1)} `:''}
            </td>
            <td class="score-col">${exp.score.toFixed(0)}</td>
        </tr>
    `).join('');
}

function resort(k) {
    if (state.sortKey === k) state.isAsc = !state.isAsc;
    else { state.sortKey = k; state.isAsc = false; }
    updateUI();
}

function getTagClass(tag) {
    const map = {"æ°´æ¡¶":"tag-bucket", "ç‡ƒæ–™":"tag-fuel", "å½ˆè—¥":"tag-ammo", "é‹åœŸ":"tag-bauxite", "é‹¼æ":"tag-steel", "æœˆå¸¸":"tag-monthly", "äº¤æˆ°":"tag-combat"};
    return map[tag] || "tag-default";
}

document.getElementById('searchBar').addEventListener('input', updateUI);
updateUI();
</script>
</body>
</html>